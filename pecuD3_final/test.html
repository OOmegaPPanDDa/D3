<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Test</title>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://d3js.org/topojson.v2.min.js"></script>
  <script src="county.js" type="text/javascript" ></script>
  <script src="https://cdn.rawgit.com/Gmousse/dataframe-js/master/lib/browser/dataframe-min.js"></script>
      

</head>
<body>

<!-- <svg width="1000px" height="800px" viewBox="0 0 800 600"></svg> -->


<script>
    var width = 950,
    height = 550;

    d3.csv('2014_train_year_flow.csv',function(stop_data){

        var projection = d3.geo.mercator()
            .scale(8000) // 地圖放大比率
            .center([120.9, 24.1]); // 指定地圖的中心點(longitude(經), latitude(緯))
           // .translate([width / 2, height / 2]); // 從中心點移動指定的px(x, y)

  // 利用 d3.geo.path 將資料轉換成 SVG Path
  var path = d3.geo.path().projection(projection);

  var svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height);

  //d3.json("county.json", function(topodata) {
    console.log(topodata);

    var features = topojson.feature(topodata, topodata.objects["county"]).features;

    svg.selectAll("path")
    .data(features).enter().append("path").attr("d",path);

    for(i=features.length - 1; i >= 0; i-- ) {
    
      features[i].properties.color_assign = (Math.random() * 100);
      console.log(features[i].properties.color_assign);
    };


    var color = d3.scale.category20();
    svg.selectAll("path").data(features).attr('d', path)
    .style('fill',
      function(d){
        return color(d.properties.color_assign)
      });





      console.log(stop_data);

      svg.selectAll("circle")
    .data(stop_data).enter()
    .append("circle")
    .attr("cx", function (d) { console.log(projection(d)); return projection(d)[0]; })
    .attr("cy", function (d) { return projection(d)[1]; })
    .attr("r", function(d){
        return rscale(d[3]);
      })
    .attr("fill", "red")

    });




  


    


    
//});


  	

</script>

</body>
</html>

