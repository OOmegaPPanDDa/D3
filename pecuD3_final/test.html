<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Test</title>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://d3js.org/topojson.v2.min.js"></script>
  <script src="county.js" type="text/javascript" ></script>
</head>
<body>
<svg width="1000px" height="800px" viewBox="0 0 800 600"></svg>


<script>


  var projection = d3.geo.mercator()
            .scale(8000) // 地圖放大比率
            .center([120.9, 24.1]); // 指定地圖的中心點(longitude(經), latitude(緯))
           // .translate([width / 2, height / 2]); // 從中心點移動指定的px(x, y)

  // 利用 d3.geo.path 將資料轉換成 SVG Path
  var path = d3.geo.path().projection(projection);

	//d3.json("county.json", function(topodata) {
		console.log(topodata);

    var features = topojson.feature(topodata, topodata.objects["county"]).features;

    d3.select("svg").selectAll("path")
    .data(features).enter().append("path").attr("d",path);

    for(i=features.length - 1; i >= 0; i-- ) {
    
      features[i].properties.color_assign = (Math.random() * 100);
      console.log(features[i].properties.color_assign);
    }

    var stop_data
    d3.csv("stop.csv", function(data) {
      stop_data = data;
    });

    var color = d3.scale.linear().domain([0,100]).range(['#00FFFF', '#00A600']);
    var svg = d3.select("svg").selectAll("path").data(features).attr('d', path)
    .style('fill',
      function(d){
        return color(d.properties.color_assign)
      });


    svg.selectAll("circle")
    .data(stop_data).enter()
    .append("circle")

    
//});


  	

</script>

</body>
</html>

